pipeline {
    agent {
        label 'Dockerize'
    }
    options {
        disableConcurrentBuilds()
        timestamps()
        timeout(time: 1, unit: 'HOURS')
    }
    parameters {
        string(name: 'jobName', defaultValue: 'ci-sonarqube', description: 'Name of the upstream job')
        string(name: 'buildNumber', defaultValue: '29', description: 'Build number of the upstream job')
        string(name: 'artifactName', defaultValue: 'target.tar.gz', description: 'Name of the artifact to download')
    }
    stages {
        stage('Dockerize') {
            steps {
                container('docker') {
                    echo 'Downloading the artifact...'
                    sh("wget ${env.JENKINS_URL}/job/${params.jobName}/${params.buildNumber}/artifact/${params.artifactName}")
                    sh("tar -xzf ${params.artifactName}")
                    echo 'Dockerizing the application...'
                    sh 'ls -l'
                }
            }
        }
    }
}
